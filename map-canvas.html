<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‹ä»¶åˆ†å¸ƒ - çš–åŒ—å†›äº‹ç¯å¢ƒæˆå› çŸ¥è¯†å›¾è°±å¹³å°</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="page-styles.css">
    <style>
        /* ç§»é™¤page-containerçš„paddingï¼Œè®©å†…å®¹å…¨å± */
        .page-container {
            min-height: calc(100vh - 200px);
            padding-top: 80px;
            width: 100%;
        }
        
        /* page-header æ ·å¼ - ä½¿ç”¨ç»Ÿä¸€çš„ page-styles.css æ ·å¼ */
        /* ç§»é™¤æœ¬åœ°è¦†ç›–ï¼Œä½¿ç”¨å…¨å±€æ ·å¼ */
        
        /* page-content æ ·å¼ */
        .page-content {
            padding: 2rem 0;
            width: 100%;
        }
        
        .page-content .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* åœ°å›¾åŒ…è£…å™¨ - å‚è€ƒå‚è€ƒç½‘ç«™ */
        .map-wrapper {
            width: 100%;
            height: 600px;
            position: relative;
            background: #f0f8ff;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        /* åœ°å›¾åŒºåŸŸæ ‡é¢˜ */
        .map-section-title {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            z-index: 100;
        }
        
        /* ç­›é€‰æ  - å‚è€ƒå‚è€ƒç½‘ç«™çš„æ ·å¼ */
        .map-filter-bar {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 100;
            border-bottom: 1px solid #e5e7eb;
        }
        
        /* ç­›é€‰çŠ¶æ€æ˜¾ç¤º */
        .filter-status {
            flex: 1;
            padding: 8px 15px;
            background: #f3f4f6;
            border-radius: 6px;
            font-size: 13px;
            color: #374151;
            min-height: 36px;
            display: flex;
            align-items: center;
        }
        
        .filter-status-label {
            font-weight: 500;
            color: #6b7280;
            margin-right: 8px;
        }
        
        .filter-status-content {
            color: #1f2937;
        }
        
        /* é‡ç½®ç­›é€‰æŒ‰é’® */
        .reset-filter-btn {
            padding: 8px 20px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .reset-filter-btn:hover {
            background: #dc2626;
        }
        
        /* ç­›é€‰ä¸‹æ‹‰æ¡† */
        .map-filter-bar select {
            padding: 8px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            background: white;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            min-width: 180px;
            transition: all 0.3s;
        }
        
        .map-filter-bar select:hover {
            border-color: #2563eb;
        }
        
        .map-filter-bar select:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
        }
        
        /* åœ°å›¾å®¹å™¨ */
        .map-canvas-container {
            width: 100%;
            height: 100%;
            position: relative;
            background: #f0f8ff;
        }
        
        #eventMapCanvas {
            width: 100%;
            height: 100%;
            cursor: move;
            display: block;
        }
        
        /* å›¾ä¾‹æ ·å¼ - å‚è€ƒå‚è€ƒç½‘ç«™ */
        .canvas-legend {
            position: absolute;
            bottom: 30px;
            left: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-width: 280px;
            z-index: 1000;
            min-width: 200px;
        }
        
        .canvas-legend h4 {
            margin: 0 0 15px 0;
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .legend-description {
            font-size: 11px;
            color: #6b7280;
            line-height: 1.5;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 13px;
            color: #374151;
        }
        
        .legend-item:last-child {
            margin-bottom: 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        /* åŸå¸‚ç“¦ç‰‡è§†å›¾ */
        .city-tiles-view {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }
        
        .city-tile {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .city-tile:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
            border-color: var(--tile-color, #2563eb);
        }
        
        .city-tile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .city-tile-name {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
            margin: 0;
        }
        
        .city-tile-count {
            font-size: 24px;
            font-weight: 700;
            color: var(--tile-color, #2563eb);
        }
        
        .city-tile-info {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .city-tile-color-indicator {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            margin-right: 8px;
        }
        
        .city-tile-label {
            font-size: 14px;
            color: #6b7280;
        }
        
        .city-tile-footer {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
            font-size: 13px;
            color: #6b7280;
        }
        
        /* è¿”å›æŒ‰é’® */
        .back-to-tiles-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
            color: #374151;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .back-to-tiles-btn:hover {
            background: #f9fafb;
            border-color: #2563eb;
            color: #2563eb;
        }
        
        .current-city-name {
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
            margin: 0;
        }
        
        .view-header {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 15px 20px;
            background: white;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .mapSelected {
            width: 100%;
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .mapSelected .map {
            display: flex;
            align-items: center;
            justify-content: flex-start; /* Align items to the start */
            height: 100%;
            padding: 0 20px;
        }
        
        .mapSelected .map > select {
            margin-right: 15px; /* Fixed spacing between selects */
        }
        
        /* è¿”å›æŒ‰é’® - å›ºå®šåœ¨å³ä¾§ */
        .back-btn-img {
            width: 50px;
            height: 48px;
            cursor: pointer;
            transition: opacity 0.3s;
            margin-left: auto;
            flex-shrink: 0;
            display: block;
            visibility: visible; /* é»˜è®¤æ˜¾ç¤ºï¼Œåœ¨å…­å¸‚è§†å›¾å’Œè¯¦ç»†è§†å›¾éƒ½æ˜¾ç¤º */
        }
        
        .back-btn-img:hover {
            opacity: 0.8;
        }
        
        /* ç­›é€‰ä¸‹æ‹‰æ¡†æ ·å¼ */
        .filter-select-item,
        .filter-select-type {
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            min-width: 180px;
            transition: all 0.3s;
        }
        
        .filter-select-item:hover,
        .filter-select-type:hover {
            border-color: #2563eb;
        }
        
        .filter-select-item:focus,
        .filter-select-type:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
        }
        
        .event-tooltip {
            position: absolute;
            background: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            pointer-events: none;
            z-index: 2000;
            display: none;
            max-width: 250px;
            font-size: 13px;
        }
        
        /* äº‹ä»¶åˆ—è¡¨é¢æ¿ */
        .events-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 350px;
            max-height: calc(100% - 40px);
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            z-index: 2001;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }
        
        .events-panel.active {
            display: flex;
        }
        
        .events-panel-header {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .events-panel-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }
        
        .events-panel-close {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
            line-height: 1;
        }
        
        .events-panel-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .events-panel-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            max-height: calc(600px - 80px);
        }
        
        .events-panel-body::-webkit-scrollbar {
            width: 8px;
        }
        
        .events-panel-body::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        .events-panel-body::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        .events-panel-body::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .event-list-item {
            padding: 12px;
            margin-bottom: 8px;
            background: #f9fafb;
            border-left: 3px solid #667eea;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .event-list-item:hover {
            background: #f3f4f6;
            border-left-color: #764ba2;
            transform: translateX(4px);
        }
        
        .event-list-item:last-child {
            margin-bottom: 0;
        }
        
        .event-list-count {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .event-list-more {
            margin-top: 12px;
            padding: 10px;
            text-align: center;
            color: #667eea;
            font-size: 14px;
            background: #f0f4ff;
            border-radius: 6px;
        }
        
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <span class="logo-icon">ğŸ—ºï¸</span>
                <span class="logo-text">çš–åŒ—å†›äº‹ç¯å¢ƒæˆå› <br>çŸ¥è¯†å›¾è°±å¹³å°</span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">é¦–é¡µ</a></li>
                <li><a href="overview.html" class="nav-link">æ•°æ®æ¦‚è§ˆ</a></li>
                <li><a href="events.html" class="nav-link">å†å²äº‹ä»¶</a></li>
                <li><a href="map-interactive.html" class="nav-link">åœ°ç†åœ°å›¾</a></li>
                <li><a href="map-canvas.html" class="nav-link active">äº‹ä»¶åˆ†å¸ƒ</a></li>
                <li><a href="persons.html" class="nav-link">äººç‰©åç‰‡</a></li>
                <li><a href="knowledgeGraph.html" class="nav-link">çŸ¥è¯†å›¾è°±</a></li>
                <li><a href="http://localhost:3000" target="_blank" class="nav-link">å®é™…ç³»ç»Ÿ</a></li>
            </ul>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- é¡µé¢å®¹å™¨ -->
    <div class="page-container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <div class="page-header page-header-distribution">
            <div class="container">
                <h1 class="page-title">äº‹ä»¶åˆ†å¸ƒ</h1>
                <p class="page-subtitle">çš–åŒ—åœ°åŒºå†å²äº‹ä»¶åœ°ç†åˆ†å¸ƒå¯è§†åŒ–</p>
            </div>
        </div>

        <!-- é¡µé¢å†…å®¹ -->
        <div class="page-content">
            <div class="container">
                <!-- ç­›é€‰æ  -->
                <div class="mapSelected">
                    <div class="map">
                        <select id="eventTypeFilter" class="filter-select-item">
                            <option value="">é€‰æ‹©äº‹ä»¶ç±»å‹</option>
                            <option value="å…¨éƒ¨äº‹ä»¶">å…¨éƒ¨äº‹ä»¶</option>
                            <option value="å†›äº‹äº‹ä»¶">å†›äº‹äº‹ä»¶</option>
                            <option value="ç¤¾ä¼šäº‹ä»¶">ç¤¾ä¼šäº‹ä»¶</option>
                            <option value="åœ°ç†å˜è¿">åœ°ç†å˜è¿</option>
                        </select>
                        <select id="regionFilter" class="filter-select-type">
                            <option value="">é€‰æ‹©åœ°åŒº</option>
                            <option value="å…¨éƒ¨åœ°åŒº">å…¨éƒ¨åœ°åŒº</option>
                            <option value="é˜œé˜³å¸‚">é˜œé˜³å¸‚</option>
                            <option value="äº³å·å¸‚">äº³å·å¸‚</option>
                            <option value="æ·®åŒ—å¸‚">æ·®åŒ—å¸‚</option>
                            <option value="å®¿å·å¸‚">å®¿å·å¸‚</option>
                            <option value="èšŒåŸ å¸‚">èšŒåŸ å¸‚</option>
                            <option value="æ·®å—å¸‚">æ·®å—å¸‚</option>
                        </select>
                        <img src="https://feiyi.inhct.cn/h5/h5images/icon_positonBack.png" id="back" alt="è¿”å›" class="back-btn-img">
                    </div>
                </div>

                <!-- åœ°å›¾åŒ…è£…å™¨ -->
                <div class="map-wrapper">
                    <!-- Canvasåœ°å›¾å®¹å™¨ -->
                    <div id="mapDetailView" class="map-canvas-container">
                        <canvas id="eventMapCanvas"></canvas>
                        
                        <!-- å›¾ä¾‹ -->
                        <div class="canvas-legend">
                            <div class="legend-item" data-range="100+">
                                <div class="legend-color" style="background: #FFD700;"></div>
                                <span>100ä»¶ä»¥ä¸Š</span>
                            </div>
                            <div class="legend-item" data-range="75-100">
                                <div class="legend-color" style="background: #FFA500;"></div>
                                <span>75-100ä»¶</span>
                            </div>
                            <div class="legend-item" data-range="50-75">
                                <div class="legend-color" style="background: #FF6347;"></div>
                                <span>50-75ä»¶</span>
                            </div>
                            <div class="legend-item" data-range="25-50">
                                <div class="legend-color" style="background: #9370DB;"></div>
                                <span>25-50ä»¶</span>
                            </div>
                            <div class="legend-item" data-range="0-25">
                                <div class="legend-color" style="background: #87CEEB;"></div>
                                <span>25ä»¶ä»¥ä¸‹</span>
                            </div>
                        </div>
                        
                        <!-- æç¤ºæ¡† -->
                        <div class="event-tooltip" id="eventTooltip"></div>
                        
                        <!-- äº‹ä»¶åˆ—è¡¨é¢æ¿ -->
                        <div class="events-panel" id="eventsPanel">
                            <div class="events-panel-header">
                                <h3 id="eventsPanelTitle">äº‹ä»¶åˆ—è¡¨</h3>
                                <button class="events-panel-close" id="eventsPanelClose">&times;</button>
                            </div>
                            <div class="events-panel-body" id="eventsPanelBody">
                                <!-- äº‹ä»¶åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€æ’å…¥ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é¡µè„š -->
    <footer class="page-footer">
        <div class="container">
            <div class="footer-nav">
                <a href="index.html">é¦–é¡µ</a>
                <span>ä¸¨</span>
                <a href="overview.html">æ•°æ®æ¦‚è§ˆ</a>
                <span>ä¸¨</span>
                <a href="events.html">å†å²äº‹ä»¶</a>
                <span>ä¸¨</span>
                <a href="map-interactive.html">åœ°ç†åœ°å›¾</a>
                <span>ä¸¨</span>
                <a href="persons.html">äººç‰©åç‰‡</a>
                <span>ä¸¨</span>
                <a href="http://localhost:3000" target="_blank">å®é™…ç³»ç»Ÿ</a>
            </div>
            <p class="footer-copyright">Â©2025 çš–åŒ—å†›äº‹ç¯å¢ƒæˆå› çŸ¥è¯†å›¾è°±å¹³å°</p>
        </div>
    </footer>

    <!-- å¼•å…¥ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="script.js?v=20250103"></script>
    <script src="page-scripts.js?v=20250103"></script>
    <script src="stats-loader.js?v=20250103"></script>
    <!-- åœ°å›¾æ¨¡å— - æŒ‰ä¾èµ–é¡ºåºåŠ è½½ -->
    <script src="js/map-modules/config.js"></script>
    <script src="js/map-modules/state.js"></script>
    <script src="js/map-modules/utils.js"></script>
    <script src="js/map-modules/coords.js"></script>
    <script src="js/map-modules/canvas-init.js"></script>
    <script src="js/map-modules/stats.js"></script>
    <script src="js/map-modules/view-adjust.js"></script>
    <script src="js/map-modules/data-loader.js"></script>
    <script src="js/map-modules/drawing.js"></script>
    <script src="js/map-modules/interaction.js"></script>
    <script src="js/map-modules/ui-update.js"></script>
    <script src="js/map-modules/view-switch.js"></script>
    <script src="js/map-modules/map-main.js"></script>
</body>
</html>



